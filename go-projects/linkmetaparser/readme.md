To-do:
[] - read the code and simplify it.
